<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Link Imóvel | Curadoria Exclusiva</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Lora:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #1e293b; 
            --accent: #2563eb; 
            --gold: #c5a059; 
            --bg: #fdfdfd;
            --text: #334155; 
            --serif: 'Lora', serif; 
            --sans: 'Inter', sans-serif;
        }

        body { 
            margin: 0; 
            padding: 0; 
            background: var(--bg); 
            font-family: var(--sans); 
            color: var(--text); 
            line-height: 1.8; 
            -webkit-font-smoothing: antialiased;
        }

        /* --- HEADER --- */
        .header { 
            padding: 35px 20px; 
            text-align: center; 
            background: #fff; 
            border-bottom: 1px solid #f1f5f9;
        }
        .logo { 
            font-family: var(--serif); 
            font-weight: 400; 
            font-size: 24px; 
            letter-spacing: 5px; 
            color: var(--primary); 
            text-transform: uppercase;
        }

        /* Hero Image com Zoom Suave */
        .hero { 
            width: 100%; 
            height: 60vh; 
            background: #000; 
            overflow: hidden; 
            position: relative; 
        }
        #foto-principal { 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            animation: softZoom 20s infinite alternate; 
            opacity: 0; /* Inicia invisível para o efeito de fade ao carregar */
            transition: opacity 1s ease-in-out;
        }
        @keyframes softZoom { 
            from { transform: scale(1); } 
            to { transform: scale(1.1); } 
        }

        /* Container Principal com espaçamento extra no fundo */
        .container { 
            max-width: 650px; 
            margin: 0 auto; 
            padding: 40px 25px 200px 25px; /* 200px de fundo para o card nunca ser cortado pelo botão */
        }

        .curadoria { 
            display: block; 
            font-size: 10px; 
            letter-spacing: 2px; 
            color: #94a3b8; 
            text-transform: uppercase; 
            margin-bottom: 20px; 
            font-weight: 400;
        }
        .curadoria b { 
            color: var(--gold); 
            font-weight: 700; 
        }

        .location { 
            text-transform: uppercase; 
            letter-spacing: 2px; 
            font-size: 11px; 
            color: var(--accent); 
            font-weight: 700; 
            margin-bottom: 10px; 
            display: block;
        }

        h1 { 
            font-family: var(--serif); 
            font-size: 34px; 
            color: var(--primary); 
            margin: 0 0 10px 0; 
            font-weight: 400; 
            line-height: 1.2; 
        }
        
        .price { 
            font-family: var(--serif); 
            font-size: 22px; 
            color: #64748b; 
            margin-bottom: 40px; 
            font-weight: 300; 
        }

        /* Ficha Técnica */
        .specs { 
            display: flex; 
            justify-content: space-between; 
            margin-bottom: 40px; 
            padding: 25px 0; 
            border-top: 1px solid #f1f5f9; 
            border-bottom: 1px solid #f1f5f9;
        }
        .spec-item { text-align: center; flex: 1; }
        .spec-label { 
            display: block; 
            font-size: 9px; 
            text-transform: uppercase; 
            color: #94a3b8; 
            letter-spacing: 1px; 
            margin-top: 5px; 
        }
        .spec-value { 
            font-weight: 600; 
            font-size: 16px; 
            color: var(--primary); 
        }

        .description { 
            font-size: 17px; 
            color: #475569; 
            margin-bottom: 60px; 
            font-weight: 300; 
            text-align: justify; 
            white-space: pre-line; 
        }

        /* --- CARD DO CORRETOR (ESTILO CLASSIC) --- */
        .corretor-card {
            background: #fff; 
            border: 1px solid #f1f5f9; 
            border-radius: 4px; 
            padding: 30px; 
            display: flex; 
            align-items: center; 
            gap: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.02);
        }

        .avatar-iniciais {
            width: 65px; 
            height: 65px; 
            background: var(--primary); 
            color: white;
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center;
            font-family: var(--serif); 
            font-size: 22px; 
            font-weight: 400; 
            flex-shrink: 0;
            border: 2px solid var(--gold);
        }

        .corretor-info { flex: 1; }
        .corretor-nome { 
            font-family: var(--serif); 
            font-size: 18px; 
            color: var(--primary); 
            margin: 0; 
            font-weight: 700; 
        }
        .corretor-creci { 
            font-size: 10px; 
            color: var(--gold); 
            letter-spacing: 1.5px; 
            text-transform: uppercase; 
            font-weight: 700; 
            display: block; 
            margin-bottom: 4px; 
        }
        .corretor-contato { 
            font-size: 12px; 
            color: #64748b; 
            margin: 0; 
            font-weight: 300; 
        }

        /* --- BOTÃO FIXO (MESMO TOM DO NOME E TÍTULO) --- */
        .cta-float {
            position: fixed; 
            bottom: 30px; 
            left: 50%; 
            transform: translateX(-50%);
            width: 85%; 
            max-width: 380px; 
            background: var(--primary); 
            color: white;
            text-decoration: none; 
            text-align: center; 
            padding: 22px; 
            border-radius: 2px; /* Borda reta conforme seu estilo classic */
            font-size: 11px; 
            font-weight: 600; 
            letter-spacing: 2px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
            z-index: 1000;
            text-transform: uppercase;
        }
        .cta-float:hover { 
            background: #000; 
            transform: translateX(-50%) translateY(-2px); 
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }
        .cta-float:active { transform: translateX(-50%) scale(0.98); }
    </style>
</head>
<body>

    <header class="header">
        <div class="logo">LINK IMÓVEL</div>
    </header>

    <div class="hero">
        <img id="foto-principal" src="" alt="Destaque">
    </div>

    <div class="container" id="main-content">
        <span class="curadoria">Imóvel de Parceiro • Curadoria <b id="corretor-nome-tag">...</b></span>
        
        <span class="location" id="imovel-local">...</span>
        <h1 id="imovel-titulo">...</h1>
        <div class="price" id="imovel-preco">...</div>

        <div class="specs">
            <div class="spec-item">
                <span class="spec-value" id="imovel-area">0</span>
                <span class="spec-label">m² Área</span>
            </div>
            <div class="spec-item">
                <span class="spec-value" id="imovel-quartos">0</span>
                <span class="spec-label">Dormitórios</span>
            </div>
            <div class="spec-item">
                <span class="spec-value" id="imovel-vagas">0</span>
                <span class="spec-label">Vagas</span>
            </div>
        </div>

        <div class="description" id="imovel-descricao">...</div>

        <div class="corretor-card">
            <div class="avatar-iniciais" id="corretor-sigla">..</div>
            <div class="corretor-info">
                <span class="corretor-creci" id="corretor-creci">CRECI ...</span>
                <h3 class="corretor-nome" id="corretor-nome-card">...</h3>
                <p class="corretor-contato" id="corretor-contato">...</p>
            </div>
        </div>
    </div>

    <a href="#" id="btn-whats" class="cta-float">
        SOLICITAR ATENDIMENTO PERSONALIZADO
    </a>

    <script>
        const SUPABASE_URL = "https://wjdqfutxtvhwdhgyqrqz.supabase.co";
        const SUPABASE_KEY = "sb_publishable_P4BgLLoKVHb0gRQ5ytOTwA_J5ELFbZ9";

        async function carregarImovel() {
            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get('id');
            if (!id) {
                console.error("ID do imóvel não fornecido.");
                return;
            }

            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/imoveis?id=eq.${id}`, {
                    headers: { 
                        "apikey": SUPABASE_KEY, 
                        "Authorization": `Bearer ${SUPABASE_KEY}` 
                    }
                });
                
                const data = await response.json();
                
                if (data && data.length > 0) {
                    const imovel = data[0];

                    // Foto com efeito Fade In
                    const img = document.getElementById("foto-principal");
                    img.src = imovel.foto_url;
                    img.onload = () => img.style.opacity = "1";

                    // Textos Básicos
                    document.getElementById("imovel-titulo").innerText = imovel.titulo;
                    document.getElementById("imovel-preco").innerText = imovel.preco;
                    document.getElementById("imovel-descricao").innerText = imovel.descricao;

                    // Área (Mantendo a vírgula e removendo apenas letras/unidades)
                    // Exemplo: "259,81 m²" vira "259,81"
                    if (imovel.area) {
                        document.getElementById("imovel-area").innerText = imovel.area.replace(/[a-zA-Z\s²]/g, "");
                    }

                    // Quartos e Vagas com 0 à esquerda
                    document.getElementById("imovel-quartos").innerText = imovel.quartos.toString().padStart(2, '0');
                    document.getElementById("imovel-vagas").innerText = imovel.vagas.toString().padStart(2, '0');

                    // Localização (Bairro + Cidade + Estado)
                    const bairroComp = imovel.bairro ? imovel.bairro + " • " : "";
                    document.getElementById("imovel-local").innerText = `${bairroComp}${imovel.cidade}, ${imovel.estado}`;

                    // Dados do Corretor
                    const nomeCompleto = imovel.corretor_nome || "Consultor Exclusivo";
                    document.getElementById("corretor-nome-tag").innerText = nomeCompleto;
                    document.getElementById("corretor-nome-card").innerText = nomeCompleto;
                    document.getElementById("corretor-creci").innerText = `CRECI ${imovel.corretor_creci || '---'}`;
                    document.getElementById("corretor-contato").innerText = `${imovel.corretor_whats} | ${imovel.corretor_id}`;
                    
                    // Iniciais do Avatar
                    const iniciais = nomeCompleto.split(" ").map(n => n[0]).join("").substring(0,2).toUpperCase();
                    document.getElementById("corretor-sigla").innerText = iniciais;

                    // Configuração do WhatsApp
                    const numLimpo = imovel.corretor_whats.replace(/\D/g, '');
                    const linkWa = `https://wa.me/55${numLimpo}?text=${encodeURIComponent('Olá! Gostaria de um atendimento personalizado para o imóvel: ' + imovel.titulo + '\n\nLink: ' + window.location.href)}`;
                    document.getElementById("btn-whats").href = linkWa;
                }

            } catch (error) {
                console.error("Erro crítico ao carregar dados do Supabase:", error);
            }
        }

        // Inicia a carga
        window.addEventListener('DOMContentLoaded', carregarImovel);
    </script>
</body>
</html>
