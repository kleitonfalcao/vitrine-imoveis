<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Link Imóvel | Exclusive Selection</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;400;600&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <style>
        :root {
            --gold: #c5a059; --dark: #0f172a; --slate: #64748b;
            --bg: #ffffff; --accent-blue: #2563eb;
        }

        body { margin: 0; padding: 0; background: var(--bg); font-family: 'Montserrat', sans-serif; color: var(--dark); line-height: 1.8; }
        
        /* Loading Refinado */
        #carregando { position: fixed; inset: 0; background: #fff; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .loader-bar { width: 100px; height: 1px; background: #eee; position: relative; overflow: hidden; margin-top: 20px; }
        .loader-bar::after { content: ''; position: absolute; left: -100%; width: 100%; height: 100%; background: var(--gold); animation: load 1.5s infinite; }
        @keyframes load { 100% { left: 100%; } }

        /* Header Minimalista */
        .header { padding: 40px 20px; text-align: center; border-bottom: 1px solid #f8fafc; }
        .logo { font-family: 'Cinzel', serif; font-size: 20px; letter-spacing: 8px; color: var(--dark); }

        /* Hero Image */
        .hero { width: 100%; height: 70vh; background: #f1f5f9; position: relative; }
        #imovel-foto { width: 100%; height: 100%; object-fit: cover; }
        .hero-overlay { position: absolute; inset: 0; background: linear-gradient(to bottom, transparent, rgba(0,0,0,0.05)); }

        /* Content Container */
        .container { max-width: 800px; margin: 0 auto; padding: 60px 25px; }

        /* Tag Imóvel Parceiro */
        .curadoria-tag { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 2px; color: var(--gold); margin-bottom: 20px; display: block; }
        .curadoria-tag span { color: var(--slate); font-weight: 300; margin-right: 5px; }

        /* Localização e Título */
        .location { font-size: 12px; text-transform: uppercase; letter-spacing: 3px; color: var(--slate); margin-bottom: 15px; display: block; }
        h1 { font-family: 'Playfair Display', serif; font-size: clamp(32px, 5vw, 48px); margin: 0 0 20px 0; font-weight: 400; color: var(--dark); line-height: 1.1; }
        
        /* Preço com Destaque */
        .price { font-size: 28px; font-weight: 300; color: var(--dark); margin-bottom: 50px; display: flex; align-items: center; gap: 15px; }
        .price::after { content: ''; flex: 1; height: 1px; background: #f1f5f9; }

        /* Grid de Especificações */
        .specs-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; padding: 30px 0; border-top: 1px solid #f1f5f9; border-bottom: 1px solid #f1f5f9; margin-bottom: 50px; }
        .spec-item { text-align: center; }
        .spec-val { display: block; font-family: 'Playfair Display', serif; font-size: 22px; color: var(--dark); }
        .spec-lab { font-size: 9px; text-transform: uppercase; letter-spacing: 2px; color: var(--slate); font-weight: 600; }

        /* Descrição */
        .desc-label { font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; color: var(--gold); margin-bottom: 25px; display: block; }
        .description { font-family: 'Montserrat', sans-serif; font-size: 16px; color: #475569; line-height: 1.9; white-space: pre-line; font-weight: 300; }

        /* Card do Corretor */
        .corretor-box { margin-top: 80px; padding: 40px; background: #fcfcfc; border: 1px solid #f1f5f9; display: flex; align-items: center; gap: 25px; border-radius: 4px; }
        .corretor-img { width: 80px; height: 80px; background: var(--dark); color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-family: 'Playfair Display', serif; font-size: 28px; }
        .corretor-info h4 { margin: 0; font-family: 'Playfair Display', serif; font-size: 20px; }
        .corretor-info p { margin: 5px 0; font-size: 11px; color: var(--slate); letter-spacing: 1px; text-transform: uppercase; }

        /* CTA WhatsApp Personalizado */
        .footer-cta { position: fixed; bottom: 0; left: 0; width: 100%; padding: 25px; background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); z-index: 90; border-top: 1px solid #f1f5f9; box-sizing: border-box; }
        .btn-whatsapp { 
            display: flex; align-items: center; justify-content: center; gap: 12px; 
            background: var(--accent-blue); color: #fff; text-decoration: none; 
            max-width: 450px; margin: 0 auto; padding: 20px; border-radius: 50px; 
            font-weight: 600; font-size: 14px; text-transform: uppercase; letter-spacing: 2px;
            transition: all 0.4s ease; box-shadow: 0 15px 30px rgba(37, 99, 235, 0.2);
        }
        .btn-whatsapp:hover { transform: translateY(-3px); box-shadow: 0 20px 40px rgba(37, 99, 235, 0.3); }
    </style>
</head>
<body>

    <div id="carregando">
        <div class="logo">LINK IMÓVEL</div>
        <div class="loader-bar"></div>
    </div>

    <header class="header">
        <div class="logo">LINK IMÓVEL</div>
    </header>

    <div class="hero">
        <div class="hero-overlay"></div>
        <img id="imovel-foto" src="" alt="Property">
    </div>

    <div class="container" id="main-content" style="display:none;">
        <span class="curadoria-tag"><span>IMÓVEL PARCEIRO |</span> CURADORIA <span id="corretor-nome-tag">...</span></span>
        
        <span class="location"><i class="bi bi-geo-alt"></i> <span id="imovel-local">...</span></span>
        <h1 id="imovel-titulo">...</h1>
        <div class="price" id="imovel-preco">...</div>

        <div class="specs-grid">
            <div class="spec-item"><span class="spec-val" id="imovel-area">0</span><span class="spec-lab">M² Privativos</span></div>
            <div class="spec-item"><span class="spec-val" id="imovel-quartos">0</span><span class="spec-lab">Suítes / Quartos</span></div>
            <div class="spec-item"><span class="spec-val" id="imovel-vagas">0</span><span class="spec-lab">Vagas</span></div>
        </div>

        <span class="desc-label">A Experiência</span>
        <div class="description" id="imovel-descricao">...</div>

        <div class="corretor-box">
            <div class="corretor-img" id="corretor-sigla">..</div>
            <div class="corretor-info">
                <p id="corretor-creci">CRECI ...</p>
                <h4 id="corretor-nome-card">...</h4>
                <p id="corretor-cidade-uf">...</p>
            </div>
        </div>
    </div>

    <div class="footer-cta">
        <a href="#" id="btn-whats-link" class="btn-whatsapp">
            <i class="bi bi-whatsapp"></i>
            SOLICITAR ATENDIMENTO PERSONALIZADO
        </a>
    </div>

    <script>
        const SUPABASE_URL = "https://wjdqfutxtvhwdhgyqrqz.supabase.co";
        const SUPABASE_KEY = "sb_publishable_P4BgLLoKVHb0gRQ5ytOTwA_J5ELFbZ9";

        async function carregar() {
            const id = new URLSearchParams(window.location.search).get('id');
            if(!id) return;

            try {
                const res = await fetch(`${SUPABASE_URL}/rest/v1/imoveis?id=eq.${id}`, {
                    headers: { "apikey": SUPABASE_KEY, "Authorization": `Bearer ${SUPABASE_KEY}` }
                });
                const dados = await res.json();
                const i = dados[0];

                // Preenchimento
                document.getElementById("imovel-foto").src = i.foto_url;
                document.getElementById("imovel-titulo").innerText = i.titulo;
                document.getElementById("imovel-preco").innerText = i.preco;
                document.getElementById("imovel-area").innerText = i.area.replace(/\D/g, "") + "M²";
                document.getElementById("imovel-quartos").innerText = i.quartos;
                document.getElementById("imovel-vagas").innerText = i.vagas;
                document.getElementById("imovel-descricao").innerText = i.descricao;
                
                // Localização (Bairro + Cidade/UF)
                const localStr = `${i.bairro ? i.bairro + ' • ' : ''}${i.cidade}/${i.estado}`;
                document.getElementById("imovel-local").innerText = localStr;

                // Corretor
                const nomeC = i.corretor_nome || "Consultor Executivo";
                document.getElementById("corretor-nome-tag").innerText = nomeC.toUpperCase();
                document.getElementById("corretor-nome-card").innerText = nomeC;
                document.getElementById("corretor-sigla").innerText = nomeC.substring(0,2).toUpperCase();
                document.getElementById("corretor-cidade-uf").innerText = `${i.cidade} / ${i.estado}`;

                // WhatsApp Link
                const whats = i.corretor_whats.replace(/\D/g, '');
                const msg = encodeURIComponent(`Olá ${nomeC}, gostaria de um atendimento personalizado para o imóvel: ${i.titulo}.\n\nReferência: ${window.location.href}`);
                document.getElementById("btn-whats-link").href = `https://wa.me/55${whats}?text=${msg}`;

                document.getElementById("carregando").style.display = "none";
                document.getElementById("main-content").style.display = "block";

            } catch(e) { console.error(e); }
        }
        carregar();
    </script>
</body>
</html>
